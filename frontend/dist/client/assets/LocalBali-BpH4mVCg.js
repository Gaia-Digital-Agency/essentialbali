import{u as V,e as _,a1 as Z,r as i,H as G,j as e,a3 as O,L as Y}from"./AdminApp-ChTaPRE2.js";import{b as q}from"./article.service-DabQZ069.js";import{A as z}from"./Advertisement-DB73lHDT.js";import{I as J}from"./Image-XJ3LueYf.js";import{g as K}from"./pagination-DPKfsKWo.js";import{f as Q}from"./format-D2eluCP0.js";import{N as W}from"./Newsletter-DC40sEjH.js";import{u as X}from"./useArticle-CClexQ19.js";import"./index-C0XMhpiw.js";import"./Button-BSzMcp9L.js";import"./newsletter.service-DRxSL4Bv.js";const D=({page:t,onClick:s,currentPage:a})=>e.jsx("div",{className:`px-4 py-2 font-medium ${typeof t=="string"?"":"cursor-pointer"} ${a==t?"text-front-red":""}`,onClick:()=>{typeof t=="string"||typeof t=="object"||s(t)},children:t}),ee=({page:t,currentPage:s,onClick:a})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prev-button cursor-pointer",onClick:()=>{a(s-1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",style:{rotate:"180deg"},children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})}),typeof t=="object"&&t.map(o=>e.jsx(D,{page:o,currentPage:s,onClick:a})),e.jsx("div",{className:"next-button cursor-pointer",onClick:()=>{a(s+1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",children:e.jsx("path",{d:"M0.589844 10.59L5.16984 6L0.589844 1.41L1.99984 0L7.99984 6L1.99984 12L0.589844 10.59Z",fill:"black"})})})]}),se=({article:t,tag:s})=>{const{getPermalink:a,getFeaturedImageUrl:o}=X();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"image-wrapper mb-5",children:e.jsx(J,{url:o(t),ratio:"100%",link:a(t)})}),t.tags&&e.jsx("div",{className:"tag-wrapper mb-2 text-front-red",children:(s==null?void 0:s.name)??""}),e.jsx("div",{className:"title-wrapper mb-5",children:e.jsx(Y,{to:a(t),viewTransition:!0,children:e.jsx("p",{className:"text-front-subtitle font-serif",children:t.title})})}),e.jsxs("div",{className:"date-wrapper flex gap-x-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"14",viewBox:"0 0 15 14",fill:"none",children:[e.jsx("path",{d:"M1.125 4.14229C1.125 3.17103 1.91236 2.38367 2.88362 2.38367H12.1164C13.0877 2.38367 13.875 3.17103 13.875 4.14229V11.6164C13.875 12.5877 13.0877 13.375 12.1164 13.375H2.88362C1.91236 13.375 1.125 12.5877 1.125 11.6164V4.14229Z",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.98267 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M11.0173 0.624878V3.70246",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M3.76294 5.90027H11.2371",stroke:"#7F7F7F","stroke-width":"0.9","stroke-linecap":"round","stroke-linejoin":"round"})]}),e.jsx("p",{className:"text-front-small text-[#A9A9A9]",children:Q(t.updatedAt)})]})]})},he=({isTrending:t=!1})=>{var N,k;const{actualRoute:s}=V(),{taxonomies:a}=_(),{initialData:o}=Z(),[g,f]=i.useState((o==null?void 0:o.articles)??[]),[S,T]=i.useState(),[C,A]=i.useState(),[j,R]=i.useState(((N=o==null?void 0:o.pagination)==null?void 0:N.totalPages)??1),[h,w]=i.useState(!1),[x,v]=i.useState(),E=["experience","ultimate-guide","featured"],[B,I]=G(),m=B.get("page"),u=m?parseInt(m):1,H=i.useRef(null);i.useEffect(()=>{var r,n;(n=(r=s.category)==null?void 0:r.tags)!=null&&n.length?v(s.category.tags):v([])},[s]),i.useEffect(()=>{w(!0),window.scrollTo(0,0)},[]),i.useEffect(()=>{h&&window.scrollTo(0,0)},[s,m]),i.useEffect(()=>{var l,y;if(!h)return;(async()=>{var b,F,L;const d=new URLSearchParams;(b=a.countries)==null||b.filter(c=>{var P;return c.id!=((P=s.country)==null?void 0:P.id)}).forEach(c=>{d.append("id_country[]",`${c.id}`)}),(F=a.categories)==null||F.filter(c=>E.includes(c.slug_title)).forEach(c=>{d.append("category[]",`${c.id}`)}),d.append("page",`${u}`),d.append("limit","9");const p=await q({},d);p!=null&&p.articles?(f(p.articles),R(((L=p.pagination)==null?void 0:L.totalPages)??1)):f([])})();const r=(l=s.category)==null?void 0:l.sub_title,n=(y=s.category)==null?void 0:y.description;T(r),A(n)},[s,m,h]);const M=r=>x==null?void 0:x.find(n=>n.id==r),$=r=>{r>j||r<=0||(w(!0),I(n=>{const l=new URLSearchParams(n);return l.set("page",`${r}`),l}))},U=()=>g.length?g.map(r=>{var l;let n;return(l=r==null?void 0:r.tags)!=null&&l.length?n=r.tags[0]:n=void 0,e.jsx(e.Fragment,{children:e.jsx("div",{className:"md:col-span-4 col-span-12",children:e.jsx(se,{article:r,tag:M(n)??void 0})})})}):e.jsx("div",{className:"col-span-12",children:"No article for this category"});return e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsxs("title",{children:[t?"Trending":"",((k=s.category)==null?void 0:k.title)??""," - essentialbali"]}),e.jsx("meta",{name:"description",content:"essentialbali is the ultimate Bali area guide for travelers, expats, and locals, featuring the best dining, events, schools, wellness, and travel in Bali"})]}),e.jsxs("section",{className:"py-12",children:[e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"ads-wrapper mb-12",children:e.jsx(z,{})}),e.jsx("div",{className:"grid grid-cols-12 mb-12",children:e.jsxs("div",{className:"md:col-span-10 md:col-start-2 col-span-12",children:[e.jsx("div",{className:"title-wrapper text-center mb-4",children:e.jsx("p",{className:"font-serif text-front-hero",children:S})}),e.jsx("div",{className:"description-wrapper text-center",children:e.jsx("p",{className:"",children:C})})]})}),e.jsx("div",{className:"grid grid-cols-12 gap-5",ref:H,children:U()}),e.jsx("div",{className:"pagination-wrapper flex justify-center gap-x-4 py-8 items-center",children:e.jsx(ee,{page:K(u,j),currentPage:u,onClick:$})})]}),e.jsx("div",{className:"newsletter-wrapper bg-front-section-grey py-8 mt-6",children:e.jsx(W,{})})]})]})};export{he as default};
