import{s as u,r as c,j as e}from"./AdminApp-ChTaPRE2.js";import{C as Y}from"./ComponentCard-BXAeiW9m.js";import{P as z}from"./PageBreadCrumb-DPyHZSFF.js";import{P as R}from"./PageMeta-B5tbE7tJ.js";import{I as l}from"./InputField-Btjg0xJq.js";import{L as i}from"./Label-Bw_W4V5I.js";import{S as U}from"./Select-BrOugipn.js";import{S as V}from"./Switch-CqfvGdqv.js";import{B as $}from"./Button-BkWwhKN1.js";import{A as I}from"./Alert-Cd3KaBGt.js";import{u as L}from"./useTimedMessage-D8LL_2fq.js";import{c as q}from"./createLucideIcon-BRWjyiVq.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],J=q("download",G),K=async()=>{try{return(await u.get("setting/admin/smtp/providers")).data}catch(t){throw console.error(t),t}},Q=async()=>{try{return(await u.get("/setting/admin/smtp?view=1")).data}catch(t){throw console.error(t),t}},W=async t=>{try{return(await u.post("/setting/admin/smtp",t)).data}catch(o){throw console.error(o),o}},X=async t=>{try{return(await u.get(`setting/admin/smtp/provider/${t}`)).data}catch(o){throw console.error(o),o}};function Z(t,o=4,m=4){return t?o+m>=t.length?"*".repeat(t.length):t.slice(0,o)+"*".repeat(t.length-o-m)+t.slice(-m):""}function pe(){const[t,o]=c.useState(""),[m,v]=c.useState([]),[j,h]=c.useState(""),[S,y]=c.useState(0),[P,w]=c.useState(""),[p,b]=c.useState(""),[C,N]=c.useState(""),[M,T]=c.useState(""),[g,x]=c.useState(null),[f,_]=c.useState(null),[A,D]=c.useState(""),[k,E]=c.useState(!1);L(f,_),L(g,x),c.useEffect(()=>{(async()=>{try{const r=await Q(),a=r==null?void 0:r.data;if(a){const d=Z(a.password??"");o(a.provider_name??""),h(a.host),y(a.port),w(a.username),b(d),N(a.from_name),T(a.from_email),D(a.secure?"Yes":"No"),E(a.secure)}}catch(r){throw console.error(r),r}})()},[]),c.useEffect(()=>{(async()=>{try{const r=await K(),a=r==null?void 0:r.data;if(a){const d=a.map(n=>({key:n.id,value:n.id,label:n.provider_name}));v(d)}}catch(r){console.error(r),v([])}})()},[]);const B=async s=>{o(String(s));const r=await X(Number(s)),a=r==null?void 0:r.data;h((a==null?void 0:a.host)??"")},F=s=>{D(s?"Yes":"No"),E(s)},H=async s=>{var a,d;s.preventDefault();const r={host:j,port:S,secure:k,username:P,from_name:C,from_email:M,is_active:!0};p&&!p.includes("*")&&(r.password=p),t&&(r.provider_name=Number(t));try{const n=await W(r);(n==null?void 0:n.status_code)==200&&(_("SMTP Configuration updated successfully"),location.reload())}catch(n){n instanceof Error&&x(n.message),typeof n=="object"&&n!==null&&"response"in n&&x(((d=(a=n.response)==null?void 0:a.data)==null?void 0:d.message)??"Something went wrong")}};return e.jsxs("div",{children:[e.jsx(R,{title:"essentialbali Admin Dashboard | SMTP Configuration",description:"This is SMTP Configuration Dashboard page for essentialbali Admin Dashboard Template"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-1",children:e.jsxs("div",{className:"space-y-12",children:[e.jsx(z,{pageTitle:"SMTP Configuration"}),e.jsxs(Y,{title:"SMTP Configuration",children:[e.jsx("div",{className:"mb-5",children:g&&e.jsx(I,{variant:"error",title:"Error",message:g})}),e.jsx("div",{className:"mb-5",children:f&&e.jsx(I,{variant:"success",title:"Success",message:f})}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"space-y-3 space-x-6 grid grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"SMTP Providers"}),e.jsx(U,{options:m,placeholder:t,onChange:s=>{B(String(s))},className:"dark:bg-dark-900"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Host"}),e.jsx(l,{type:"text",onChange:s=>h(s.target.value),placeholder:j})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Port"}),e.jsx(l,{type:"text",onChange:s=>y(Number(s.target.value)),placeholder:S})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Secure"}),e.jsx(V,{label:A,checked:k,onChange:F})]})]}),e.jsxs("div",{className:"space-y-3 space-x-6 grid grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Username"}),e.jsx(l,{type:"text",onChange:s=>w(s.target.value),placeholder:P})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Password"}),e.jsx(l,{type:"text",onChange:s=>b(s.target.value),placeholder:p}),e.jsx("small",{className:"text-red-500 text-xs",children:"* Leave this field empty to keep your current password."})]}),e.jsxs("div",{children:[e.jsx(i,{children:"From Name"}),e.jsx(l,{type:"text",onChange:s=>N(s.target.value),placeholder:C})]}),e.jsxs("div",{children:[e.jsx(i,{children:"From Email"}),e.jsx(l,{type:"text",onChange:s=>T(s.target.value),placeholder:M})]})]}),e.jsx("div",{className:"space-y-6 space-x-6 flex justify-end",children:e.jsx($,{startIcon:e.jsx(J,{className:"size-5"}),className:"w-1/8",children:"Save"})})]})]})]})})]})}export{pe as default};
