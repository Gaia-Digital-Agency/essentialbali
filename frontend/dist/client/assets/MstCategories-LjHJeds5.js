import{r as o,j as e,t as ce,v as X,w as de,x as xe,y as ge,z as me,B as he}from"./AdminApp-ChTaPRE2.js";import{P as pe}from"./PageMeta-B5tbE7tJ.js";import{C as ee}from"./ComponentCard-BXAeiW9m.js";import{I}from"./InputField-Btjg0xJq.js";import{L as u}from"./Label-Bw_W4V5I.js";import{B as $}from"./Button-BkWwhKN1.js";import{S as q}from"./Select-BrOugipn.js";import{T as ue}from"./TextArea-XtACzk4h.js";import{R as A}from"./Radio-CBZLAntu.js";import{A as G}from"./Alert-Cd3KaBGt.js";import{t as J}from"./slugify-CPdjgS2J.js";import{u as Q}from"./useTimedMessage-D8LL_2fq.js";import{S as ye}from"./react-select.esm-BAaERCas.js";import{g as be}from"./tags.service-F0XCpcCN.js";import{c as fe}from"./createLucideIcon-BRWjyiVq.js";import{T as je,a as ve,b as V,c,d as Se}from"./index-DxIT6uDb.js";import{S as W}from"./sweetalert2.esm.all-BbQndx0i.js";import{w as K}from"./sweetalert2-react-content.es-CEkjcN0-.js";import{P as we}from"./PaginationWithButton-CHceJPkP.js";import{P as ke}from"./PageBreadCrumb-DPyHZSFF.js";import"./createSuper-CJDnspyc.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Te=fe("info",Ne),Ce=({message:s})=>e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(Te,{}),e.jsx("div",{className:"invisible absolute w-48 text-wrap z-50 bottom-full left-1/2 mb-2.5 border border-black -translate-x-1/2 opacity-0 transition-opacity duration-300 group-hover:visible group-hover:opacity-100",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"drop-shadow-4xl whitespace-nowrap rounded-lg bg-white px-3 py-2 text-md font-medium text-gray-700 dark:bg-[#1E2634] dark:text-white",children:s}),e.jsx("div",{className:"absolute -bottom-1 left-1/2 h-3 w-4 -translate-x-1/2 rotate-45 bg-white dark:bg-[#1E2634]"})]})})]}),De=({label:s,children:y,tooltip:g})=>e.jsxs("div",{className:"input-wrapper",children:[e.jsxs("div",{className:"label-wrapper mb-4 flex gap-x-2 items-center",children:[e.jsx("p",{children:s}),g&&e.jsx(Ce,{message:g})]}),y]});function Pe({selectedCategory:s,clearSelected:y,onSaveSuccess:g,refreshKey:m}){const[d,h]=o.useState(""),[P,x]=o.useState(""),[L,p]=o.useState(""),[_,w]=o.useState(""),[M,R]=o.useState([]),[N,b]=o.useState(0),[E,T]=o.useState(""),[f,j]=o.useState(null),[C,t]=o.useState(null),[r,v]=o.useState("global"),[S,k]=o.useState([]),[D,H]=o.useState(0),[te,ae]=o.useState(!1);o.useEffect(()=>{s&&(console.log("selectedCategory",typeof s.is_child),h(s.title),x(s.sub_title),p(s.slug_title),w(s.description),b(s.id_parent),T(s.template_name),z(s.tag??[]),ae(s.is_child))},[s]),o.useEffect(()=>{(async()=>{var l;try{const n={key:0,value:0,label:"Select Bali Scope"};let i;if(r!=="global"){i=await ce(r);const Z=((l=i.data)==null?void 0:l.map(O=>({key:O.id,value:O.id,label:O.name})))??[];k([n,...Z])}else k([n])}catch(n){throw console.error(n),n}})()},[r]),o.useEffect(()=>{(async()=>{try{const n=(await X()).data.map(i=>({value:i.id,label:i.title}));R(n)}catch(l){console.error("Error fetching data:",l)}})()},[m]);const re=async a=>{var l,n;a.preventDefault();try{const i={title:d,sub_title:P,slug_title:J(L),description:_,id_parent:N,template_name:E,tag:Y};if(r!=="global"){if(!D){j("Please Select Bali Scope");return}r==="country"?i.id_country=D:r==="city"?i.id_city=D:r==="region"&&(i.id_region=D)}s?(await de(s.id,i),t(d+" is Updated Successfully")):(await xe(i),t(d+" is Created Successfully")),y(),t(d+" is Created Successfully"),h(""),x(""),p(""),w(""),b(0),T(""),H(0),v("global"),z([]),g()}catch(i){i instanceof Error&&j(i.message),typeof i=="object"&&i!==null&&"response"in i&&j(((n=(l=i.response)==null?void 0:l.data)==null?void 0:n.message)??"Something went wrong"),window.scrollTo({top:0,behavior:"smooth"})}},se=a=>{const l=a.target.value,n=s?s.slug_title:J(l);h(l),p(n)},U=async a=>{if(H(Number(a)),s)try{const n=(await ge(r,Number(a),s.id)).data;w(n.description),x(n.sub_title)}catch(l){throw console.error(l),l}},oe=a=>{b(Number(a))},B=async a=>{v(a),H(0),await U(0)};Q(C,t),Q(f,j);const[F,le]=o.useState([]),[Y,z]=o.useState([]);o.useEffect(()=>{(async()=>{try{const l=await be();le(l.data)}catch(l){console.error(l)}})()},[]);const ie=a=>{z(a.map(l=>l.value))},ne=()=>{if(!(!F.length||te))return e.jsx(De,{label:"Related Tags",children:e.jsx(ye,{options:F.map(a=>({label:a.name,value:a.id})),isMulti:!0,onChange:ie,value:F.filter(a=>Y.includes(a.id)).map(a=>({value:a.id,label:a.name}))})})};return e.jsx(e.Fragment,{children:e.jsxs(ee,{title:s?"Edit Category":"Add Category",children:[e.jsx("div",{className:"mb-5",children:f&&e.jsx(G,{variant:"error",title:"Error",message:f})}),e.jsx("div",{className:"mb-5",children:C&&e.jsx(G,{variant:"success",title:"Success",message:C})}),e.jsx("form",{onSubmit:re,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"cCategoryTitle",children:"Category Title"}),e.jsx(I,{type:"text",id:"cCategoryTitle",onChange:se,value:d,placeholder:"Acme"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"cSlug",children:"Slug"}),e.jsx(I,{type:"text",id:"cSlug",onChange:a=>p(a.target.value),value:L,placeholder:"slug-category"})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Bali Scope"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-8",children:[e.jsx(A,{id:"optLocationType_global",name:"group1",value:"global",checked:r==="global",onChange:B,label:"All Bali"}),e.jsx(A,{id:"optLocationType_country",name:"group1",value:"country",checked:r==="country",onChange:B,label:"Bali Area"}),e.jsx(A,{id:"optLocationType_city",name:"group1",value:"city",checked:r==="city",onChange:B,label:"Sub Area"}),e.jsx(A,{id:"optLocationType_region",name:"group1",value:"region",checked:r==="region",onChange:B,label:"Local Zone"})]})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Bali Scope"}),e.jsx(q,{options:S,value:D,placeholder:"Select Bali Scope",onChange:U,className:"h-lg dark:bg-dark-900"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"cCategorySubTitle",children:"Category Sub Title"}),e.jsx(I,{type:"text",id:"cCategorySubTitle",onChange:a=>x(a.target.value),value:P,placeholder:"Sub Title..."})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Description"}),e.jsx(ue,{value:_,onChange:a=>w(a),rows:6,placeholder:"Enter Description..."})]}),e.jsxs("div",{children:[e.jsx(u,{children:"ID Parent"}),e.jsx(q,{options:[{value:0,label:"-"},...M],value:N,placeholder:"Select an option",onChange:oe,className:"h-lg dark:bg-dark-900"})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Template Name"}),e.jsx(I,{type:"text",id:"cTemplateName",onChange:a=>T(a.target.value),value:E,placeholder:"Template Name..."})]}),ne(),e.jsx("div",{className:"flex justify-end",children:e.jsx($,{className:"w-1/3",children:"Save"})})]})})]})})}function Le({refreshKey:s,onEditCategory:y,onSaveSuccess:g}){const[m,d]=o.useState([]),[h,P]=o.useState(1),[x,L]=o.useState(5),[p,_]=o.useState("");o.useEffect(()=>{(async()=>{try{const r=await X();d(r.data)}catch(r){console.error("Error fetching data:",r)}})()},[s]);async function w(t){try{const r=await me(t);y(r.data),window.scrollTo({top:0,behavior:"smooth"})}catch(r){console.error("Error fetching data:",r)}}async function M(t){var r,v;try{await he(t),g(),K(W).fire({title:"Deleted!",text:"Category has been deleted.",icon:"success"})}catch(S){console.error("Error deleting category:",S);let k="Failed to delete category";(v=(r=S.response)==null?void 0:r.data)!=null&&v.message?k=S.response.data.message:S.message&&(k=S.message),K(W).fire({title:"Error",text:k,icon:"error"})}}const R=(t,r)=>{K(W).fire({title:`Are you sure to Delete ${t}?`,text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0}).then(v=>{v.isConfirmed&&M(r)})},N=o.useMemo(()=>m.filter(t=>[t.title,t.slug_title,t.sub_title].some(r=>r==null?void 0:r.toLowerCase().includes(p.toLowerCase()))),[m,p]),b=N.length,E=Math.ceil(b/x),T=t=>{P(t)},f=(h-1)*x,j=Math.min(f+x,b),C=N.slice(f,j);return e.jsx(e.Fragment,{children:e.jsx(ee,{title:"Category Datas",children:e.jsxs("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/[0.05] dark:bg-white/[0.03]",children:[e.jsxs("div",{className:"flex flex-col gap-2 px-4 py-4 border border-b-1 border-gray-100 dark:border-white/[0.05] rounded-t-xl sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:" Show "}),e.jsxs("div",{className:"relative z-20 bg-transparent",children:[e.jsx("select",{className:"w-full py-2 pl-3 pr-8 text-sm text-gray-800 bg-transparent border border-gray-300 rounded-lg appearance-none dark:bg-dark-900 h-9 bg-none shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",value:x,onChange:t=>L(Number(t.target.value)),children:[5,10].map(t=>e.jsx("option",{value:t,className:"text-gray-500 dark:bg-gray-900 dark:text-gray-400",children:t},t))}),e.jsx("span",{className:"absolute z-30 text-gray-500 -translate-y-1/2 right-2 top-1/2 dark:text-gray-400",children:e.jsx("svg",{className:"stroke-current",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M3.8335 5.9165L8.00016 10.0832L12.1668 5.9165",stroke:"",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[" ","entries"," "]})]}),e.jsx("input",{type:"text",placeholder:"Search...",className:"px-3 py-2 text-sm border rounded-lg dark:bg-gray-800 dark:text-white",value:p,onChange:t=>_(t.target.value)})]}),e.jsx("div",{className:"max-w-full overflow-x-auto",children:e.jsxs(je,{children:[e.jsx(ve,{className:"border-b border-l-amber-800 dark:border-white/[0.05]",children:e.jsxs(V,{children:[e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400 max-w-[10px]",children:"Title"}),e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400",children:"Sub Title"}),e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400",children:"Slug"}),e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400",children:"Parent Category"}),e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400",children:"Edit?"}),e.jsx(c,{isHeader:!0,className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-sm dark:text-gray-400",children:"Delete"})]})}),e.jsx(Se,{className:"divide-y divide-gray-100 dark:divide-white/[0.05]",children:C.map(t=>e.jsxs(V,{children:[e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:t.title}),e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:t.sub_title}),e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:t.slug_title}),e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:t.parent}),e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:e.jsx($,{onClick:()=>w(t.id),size:"sm",className:"bg-green-600 hover:bg-green-700",children:"Edit"})}),e.jsx(c,{className:"px-4 py-3 text-gray-500 text-start text-theme-lg dark:text-gray-400",children:e.jsx($,{onClick:()=>R(t.title,t.id),size:"sm",className:"bg-red-400 hover:bg-red-700",children:"Delete"})})]},t.id))})]})}),e.jsx("div",{className:"border border-t-1 rounded-b-xl border-gray-100 py-4 pl-[18px] pr-4 dark:border-white/[0.05]",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-center xl:justify-between",children:[e.jsx("div",{className:"pt-3 xl:pt-0",children:e.jsxs("p",{className:"pt-3 text-sm font-medium text-center text-gray-500 border-t border-gray-100 dark:border-gray-800 dark:text-gray-400 xl:border-t-0 xl:pt-0 xl:text-left",children:["Showing ",f+1," to ",j," of ",b," entries"]})}),e.jsx(we,{totalPages:E,initialPage:h,onPageChange:T})]})})]})})})}function Ve(){const[s,y]=o.useState(0),[g,m]=o.useState(null);function d(){y(h=>h+1),m(null)}return e.jsxs("div",{children:[e.jsx(pe,{title:"essentialbali Admin Dashboard | Master Categories",description:"This is Master Categories Dashboard page for essentialbali Admin Dashboard Template"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-1",children:e.jsxs("div",{className:"space-y-12",children:[e.jsx(ke,{pageTitle:"Master Categories"}),e.jsx(Pe,{selectedCategory:g,onSaveSuccess:d,clearSelected:()=>m(null),refreshKey:s}),e.jsx(Le,{refreshKey:s,onEditCategory:m,onSaveSuccess:d})]})})]})}export{Ve as default};
